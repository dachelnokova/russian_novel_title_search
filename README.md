# Поиск по заглавиям романов

Поиск по заголовкам русских романов тремя методами:

* **Полнотекстовый поиск (TF-IDF):**  Использует `sklearn.feature_extraction.text.TfidfVectorizer` для векторизации текста и косинусное сходство для поиска. Данные проходят предобработку, включающую приведение к нижнему регистру, токенизацию, удаление стоп-слов (nltk) и лемматизацию с помощью pymorphy2.
Удаление стоп-слов.
* **Векторный поиск (SBERT):**  Использует модель `sberbank-ai/sbert_large_nlu_ru`, поскольку она большая и предобучена на русских текстах (косинусное сходство для поиска). Предобработка текстов не реализовывалась, так как SBERT обучен на сырых текстах.
* **Гибридный поиск (TF-IDF + SBERT):**  Гибридный поиск комбинирует результаты полнотекстового (TF-IDF) и векторного (SBERT) поиска с помощью взвешенного усреднения оценок релевантности. Вес для каждого метода равен (0.5).


## Файлы
* `rus_novel_titles.csv`:  Датасет с заголовками русских романов, 2035 заглавий, 1763-1917 гг.
* `sbert_large_nlu_ru_embeddings.npy`:  Предобученные эмбеддинги SBERT для заголовков датасета.
* `tfidf_matrix.pkl`:  Матрица TF-IDF для заголовков датасета.
* `tfidf_vectorizer.pkl`:  Векторизатор TF-IDF.
* `search.py`:  Основной скрипт для поиска.
* `requirements.txt`:  Список необходимых библиотек.



## Запуск
1. Установка зависимостей:
```bash
pip install -r requirements.txt
```

2. Запуск скрипта:
На вход программа принимает такие параметры, как поисковый запрос, количество результатов для выдачи и метод поиска. На выходе - топ документов в порядке убывания релевантности, а также время исполнения программы.
```bash
python search.py --query "ваш запрос" --count <количество результатов> --method <метод поиска>  
```

Аргументы:  
--query: Поисковый запрос.  
--count: Количество результатов для выдачи.  
--method: Метод поиска (full_text, sbert, hybrid).  

## Примеры
```bash
python search.py --query "Отцы и дети" --count 5 --method full_text
```

```bash
Ваш поисковой запрос: Отцы и дети  
Выбранный метод поиска: full_text  
Количество результатов для выдачи: 5  
Время исполнения: 0.0087 секунд  
1. Скор: 1.0000  
Заглавие: Отцы и дети  

2. Скор: 0.7284  
Заглавие: Дети  

3. Скор: 0.5384  
Заглавие: Дети земли  

4. Скор: 0.4754  
Заглавие: Нежеланные дети  

5. Скор: 0.4694  
Заглавие: За грехи отца

```
